<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stone Neilon">
<meta name="dcterms.date" content="2025-01-14">
<meta name="description" content="Professor: Brian Cadena">

<title>Stone Neilon - Applied Econometrics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Stone Neilon</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://drive.google.com/file/d/1RgKR73KnxS3K_AP2nqiTiZZzAL-zJZ2N/view?usp=sharing"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#week-1" id="toc-week-1" class="nav-link active" data-scroll-target="#week-1">Week 1</a>
  <ul class="collapse">
  <li><a href="#regression-review" id="toc-regression-review" class="nav-link" data-scroll-target="#regression-review">Regression Review</a>
  <ul class="collapse">
  <li><a href="#functional-form-changes" id="toc-functional-form-changes" class="nav-link" data-scroll-target="#functional-form-changes">Functional Form Changes</a></li>
  <li><a href="#polynomials-of-x" id="toc-polynomials-of-x" class="nav-link" data-scroll-target="#polynomials-of-x">Polynomials of x</a></li>
  <li><a href="#categorical-variables" id="toc-categorical-variables" class="nav-link" data-scroll-target="#categorical-variables">Categorical variables</a></li>
  <li><a href="#interactions" id="toc-interactions" class="nav-link" data-scroll-target="#interactions">Interactions</a></li>
  <li><a href="#control-variables" id="toc-control-variables" class="nav-link" data-scroll-target="#control-variables">Control Variables</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#week-4" id="toc-week-4" class="nav-link" data-scroll-target="#week-4">Week 4</a></li>
  <li><a href="#regression-and-causality" id="toc-regression-and-causality" class="nav-link" data-scroll-target="#regression-and-causality">Regression and Causality</a></li>
  <li><a href="#week-5" id="toc-week-5" class="nav-link" data-scroll-target="#week-5">Week 5</a></li>
  <li><a href="#propensity-score-matching" id="toc-propensity-score-matching" class="nav-link" data-scroll-target="#propensity-score-matching">Propensity Score Matching</a></li>
  <li><a href="#panel-data" id="toc-panel-data" class="nav-link" data-scroll-target="#panel-data">Panel Data</a></li>
  <li><a href="#diff-in-diff" id="toc-diff-in-diff" class="nav-link" data-scroll-target="#diff-in-diff">Diff-in-Diff</a>
  <ul class="collapse">
  <li><a href="#when-to-use-it" id="toc-when-to-use-it" class="nav-link" data-scroll-target="#when-to-use-it">When to Use It:</a></li>
  </ul></li>
  <li><a href="#beyond-2x2-did---single-treatment-time" id="toc-beyond-2x2-did---single-treatment-time" class="nav-link" data-scroll-target="#beyond-2x2-did---single-treatment-time">Beyond 2x2 DiD - Single Treatment Time</a>
  <ul class="collapse">
  <li><a href="#placebo-analysis" id="toc-placebo-analysis" class="nav-link" data-scroll-target="#placebo-analysis">Placebo Analysis</a></li>
  <li><a href="#triple-difference-setup" id="toc-triple-difference-setup" class="nav-link" data-scroll-target="#triple-difference-setup">Triple Difference Setup</a></li>
  <li><a href="#when-we-use-diff-in-diff-as-an-empirical-strategy" id="toc-when-we-use-diff-in-diff-as-an-empirical-strategy" class="nav-link" data-scroll-target="#when-we-use-diff-in-diff-as-an-empirical-strategy">WHEN WE USE DIFF IN DIFF AS AN EMPIRICAL STRATEGY</a></li>
  <li><a href="#synthetic-diff-in-diff" id="toc-synthetic-diff-in-diff" class="nav-link" data-scroll-target="#synthetic-diff-in-diff">Synthetic Diff-in-Diff</a></li>
  <li><a href="#staggered-adoption-methods" id="toc-staggered-adoption-methods" class="nav-link" data-scroll-target="#staggered-adoption-methods">Staggered Adoption Methods</a></li>
  </ul></li>
  <li><a href="#fixed-effects-and-panel-data" id="toc-fixed-effects-and-panel-data" class="nav-link" data-scroll-target="#fixed-effects-and-panel-data">Fixed Effects and Panel Data</a></li>
  <li><a href="#instrumental-variables" id="toc-instrumental-variables" class="nav-link" data-scroll-target="#instrumental-variables">Instrumental Variables</a></li>
  <li><a href="#first-differences" id="toc-first-differences" class="nav-link" data-scroll-target="#first-differences">First differences</a></li>
  <li><a href="#standard-errors" id="toc-standard-errors" class="nav-link" data-scroll-target="#standard-errors">Standard Errors</a>
  <ul class="collapse">
  <li><a href="#the-moulton-problem" id="toc-the-moulton-problem" class="nav-link" data-scroll-target="#the-moulton-problem">The Moulton Problem</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Applied Econometrics</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Fall</div>
    <div class="quarto-category">2025</div>
    <div class="quarto-category">Methods</div>
  </div>
  </div>

<div>
  <div class="description">
    Professor: Brian Cadena
  </div>
</div>

<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://stoneneilon.github.io/">Stone Neilon</a> <a href="https://orcid.org/0009-0006-6026-4384" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.colorado.edu/polisci/people/graduate-students/stone-neilon">
            PhD student of political science @ The University of Colorado Boulder
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 14, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="week-1" class="level1">
<h1>Week 1</h1>
<ul>
<li><p>Period (.) is an NA value.</p></li>
<li><p>mean of a dummy variable does tell us something.</p></li>
<li><p>Words in blue is actually just a labeling scheme to another value. This makes it easier to read but still keeping same value.</p></li>
<li><p>Why do you log? Heteroskedasticity and interpretation.</p></li>
</ul>
<section id="regression-review" class="level2">
<h2 class="anchored" data-anchor-id="regression-review">Regression Review</h2>
<ul>
<li><p>Regression as an Estimate of the CEF</p>
<ul>
<li><p>Conditional Expectation Function E[y|x]</p></li>
<li><p>Regression is a way of calculating means for different types of observations with different values of x.</p></li>
</ul></li>
<li><p>We are trying to come up with a CEF that fits a cloud of points.</p></li>
<li><p>Regression: lets pick a line that minimizes the sum of squared residuals.</p></li>
<li><p>don’t forget the “on average” part when interpreting.</p></li>
<li><p>the intercept is a specific Conditional expectation value.</p></li>
<li><p>Constant is the expected value when all values of X are zero. This is why we don’t really care about it because it is substantively unimportant.</p></li>
<li><p>We need to contextualize the size of our coefficient.</p></li>
<li><p>important to rescale the x variable.</p></li>
<li><p><strong>coefficient / standard error = t stat.</strong></p>
<ul>
<li><p>know what null hypothesis is!</p></li>
<li><p>in the example: <span class="math display">\[t = \frac{\hat{\beta}-0}{se}\]</span></p>
<ul>
<li><p>0 is our null hypothesis.</p></li>
<li><p>let’s say the null wasn’t zero</p>
<ul>
<li><p>see slides and do file.</p></li>
<li><p>also look at the confidence interval</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>t- stat and p-value are saying the same thing.</p></li>
<li><p>Start with the null hypothesis being true. If the Null is true then the probability of observing the value we observed is the p-value.</p>
<ul>
<li>if its null is zero, is it strange to get the coefficient i got?</li>
</ul></li>
<li><p>The null hypothesis in a constant is zero. The line goes through the origin is the null basically.</p></li>
<li><p>iid!</p></li>
<li><p>homoscedasticity is an important assumption!</p>
<ul>
<li>its basically never true.</li>
</ul></li>
<li><p>standard error is square root of the VCV matrix.</p></li>
<li><p>What are robust standard errors</p>
<ul>
<li><p>robust to heteroskedasticity</p>
<ul>
<li><p>robust means resistant/strong.</p></li>
<li><p>these are standard errors that are robust even if if our errors have heteroskedasitcity. The standard errors are strong enough.</p>
<ul>
<li>wont change our coefficients.</li>
<li>usually when we robust, our SE will get bigger - more conservative in our hypothesis testing.</li>
</ul></li>
</ul></li>
</ul></li>
<li><p>What goes in the omega matrix</p>
<ul>
<li>residuals squared on the main diagonal and zeros on the off diagonal.</li>
</ul></li>
<li><p>We pretty much always use robust standard errors.</p>
<ul>
<li><p>reg wage points, robust</p>
<ul>
<li><p>this is the code to have robust standard errors.</p></li>
<li><p>wont change our betas but will influence our standard errors and t-stats and p-values.</p></li>
</ul></li>
</ul></li>
<li><p>The upper and lower bounds of our CI will tell us the values that have exactly a p-value of .05.</p></li>
<li><p>Don’t just look at stars.</p></li>
<li><p>lincom - take the recent regression, linear combination.</p></li>
<li><p>Regression output - see do file. for latex just do “tex” for latex output.</p></li>
</ul>
<section id="functional-form-changes" class="level3">
<h3 class="anchored" data-anchor-id="functional-form-changes">Functional Form Changes</h3>
<ul>
<li><p>suppose we want to log our y</p>
<ul>
<li><p>gen logwage = log(wage)</p></li>
<li><p>reg logwage points, robust</p></li>
</ul></li>
<li><p>the log salary increase is .09.</p>
<ul>
<li><p>proprotional change in y when x goes up by one unit.</p>
<ul>
<li><p>so it is percent.</p>
<ul>
<li>one unit change in x = a 9% change in y</li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Log of constant is pretty lame and irrelevant.</p></li>
<li><p>Why log y or x?</p>
<ul>
<li><p>it doesnt make sense to log variables that are already proportions.</p></li>
<li><p>Goal is to approximate CEF with linear form.</p>
<ul>
<li><p>the reason people log is because we are trying to approximate the CEF with a linear form!</p>
<ul>
<li><p>“I think the real world works in a proportional sense”</p>
<ul>
<li>does one of those sentences make more sense than the other (log vs non log results)</li>
</ul></li>
<li><p>reasonable shared effect of x on y.</p>
<ul>
<li>counties grew on average by 15k OR counties grew on average of 2%</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="polynomials-of-x" class="level3">
<h3 class="anchored" data-anchor-id="polynomials-of-x">Polynomials of x</h3>
<ul>
<li><p>Why square the x?</p></li>
<li><p>providing flexibility - don’t think of x^2 as a control</p></li>
<li><p><span class="math inline">\(y = \beta_0 + \beta_1x+\beta_2x^2\)</span></p>
<ul>
<li><span class="math inline">\(\frac{dy}{dx} = \beta_1+2\beta_2x\)</span></li>
</ul></li>
<li><p>Null hypothesis in class example for quadratic is the line straight?</p></li>
</ul>
</section>
<section id="categorical-variables" class="level3">
<h3 class="anchored" data-anchor-id="categorical-variables">Categorical variables</h3>
<ul>
<li><p>Cardinal - the numerical value has a meaning</p>
<ul>
<li><p>treating an x as continuous imposes cardinality. if you cannot justify that assumption, treat as if unordered.</p>
<ul>
<li>it doesn’t make sense race increases by one unit. Thus, you should always treat as unordered and run as a factor.</li>
</ul></li>
</ul></li>
<li><p>ordinal -</p></li>
<li><p>unordered -</p></li>
</ul>
<p>F stat - is joint slopes are all equal to 0.</p>
<ul>
<li><p>Dummy variable trap = include all categories, you get perfect multicollinearity.</p>
<ul>
<li>non-invertable matrix is what is happening under the hood.</li>
</ul></li>
<li><p>What happens if you leave out too many categories?</p>
<ul>
<li><p>lets say we leave out two cats</p>
<ul>
<li><p>constant is just average of cat1 or cat 2.</p></li>
<li><p>interpretation just sucks.</p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="interactions" class="level3">
<h3 class="anchored" data-anchor-id="interactions">Interactions</h3>
<p>TK MAKE SURE YOU INCLUDE TABLE OUTPUT!</p>
<ul>
<li><p>Is the relationship between y and x, the same for 2 different groups/subsets/types (or more).</p></li>
<li><p>the coefficient in female is just the difference compared to the coefficient. (for in class example)</p>
<ul>
<li>yeared coefficient is the slope for men.</li>
</ul></li>
<li><p>the reason we run an interaction is not because we didnt know anyhting among hte coefficients but it is because we are interested in everything after. We know they are different slopes but are they statistically different?</p></li>
<li><p>take derivative with respect to female.</p>
<ul>
<li><p>0 + beta1 + 0 + beta2 yearsed</p></li>
<li><p>derivatives are your friend in interactions.</p></li>
</ul></li>
</ul>
</section>
<section id="control-variables" class="level3">
<h3 class="anchored" data-anchor-id="control-variables">Control Variables</h3>
<ul>
<li><p>To some extent we actually keep doing bivariate regressions but in a weird way.</p></li>
<li><p>saying hold this one variable constant.</p></li>
<li><p>when you say all else equal it insinuates a causal claim.</p></li>
<li><p>need to standardize coefficients for interpretation.</p></li>
<li><p>scale of x variable determines the scale of your coefficient.</p></li>
<li><p>Frisch Waugh Lovel FWL Theorem</p>
<ul>
<li><p>aftq on loginc</p></li>
<li><p>aftq on years of ed</p></li>
<li><p>look closely at multiple regression stata do file.</p></li>
<li><p>we are basically running extra regressions.</p>
<ul>
<li>its not magic - using regressions to purge influence of X2 on X1 and Y.</li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
</section>
<section id="week-4" class="level1">
<h1>Week 4</h1>
<ul>
<li><p>Problem set 3 answers posted.</p></li>
<li><p>Problem set 4 is long.</p></li>
<li><p>internal validity: will this research design give me an unbiased estimate of the parameter that I am claiming ot estimate</p>
<ul>
<li>RCT - want to estimate ATE. - will my design actually give me an unbiased estimate of the ATE.</li>
</ul></li>
<li><p>external validity: does this parameter generalize?</p></li>
<li><p>why include control variables in a RCT regression.</p></li>
<li><p>ATE - best case scenario:</p>
<ul>
<li><p>Required Assumption to identify parameter: Randomization done correctly</p></li>
<li><p>Fights with reviewers: External Validity, Sample Size (precision)</p></li>
</ul></li>
<li><p>Estimand - the target - what we are trying to learn</p></li>
<li><p>estimator - the thing we actually do with out data. We use this to estimate our estimand.</p></li>
</ul>
</section>
<section id="regression-and-causality" class="level1">
<h1>Regression and Causality</h1>
<ul>
<li><p>Imagine you didn’t run an experiment - or there is no obvious natural experiment.</p>
<ul>
<li><p>we just have some cross sectional data.</p>
<ul>
<li><p>i am interested in this variable but it wasn’t randomly assigned.</p>
<ul>
<li><p>but i have a lot of other variables I can use to control for.</p>
<ul>
<li>when do i actually have a causal model?</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Can we ever get causality from a regression?</p>
<ul>
<li><p><strong>when the conditional independence assumption holds.</strong></p>
<ul>
<li><p>what is that?</p>
<ul>
<li><p>actual treatment status is independent of the outcomes.</p>
<ul>
<li><p>if you could take your data and find observations that have the same values on everything but have variation on some treated/untreated variable - what is the effect?</p></li>
<li><p>basically you are finding the counterfactual.</p>
<ul>
<li>not perfect - example - look at Prince Charles and Ozzy Osbourne.</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li><p><span class="math inline">\(Y_{si}=f_i(s)\)</span></p>
<ul>
<li>notation for all possible potential outcomes</li>
</ul></li>
<li><p>CIA suggests that we can estimate many causal effects, but need more structure for regression motivation.</p></li>
<li><p>no i on coefficient on CIA to regression slide.</p></li>
<li><p>This is basically all just omitted variable bias</p></li>
<li><p>Question: if a full regression model has a causal interp. and I leave out a variable, what goes wrong?</p>
<ul>
<li><strong>It is a bias estimate of the truth!!!!!</strong></li>
</ul></li>
<li><p>Long regression vs short regression:</p>
<ul>
<li><p>what happens when you have OVB?</p>
<ul>
<li>See slides with the big formuals</li>
</ul></li>
</ul></li>
<li><p>OVB it moves your bias on a number line - It has a direction! it is either positive or negative!</p></li>
</ul>
</section>
<section id="week-5" class="level1">
<h1>Week 5</h1>
<ul>
<li><p>Does FWL give me variation that is as good as an experiment?</p></li>
<li><p>it is fine to leave out variables that don t have an effect on the outcome.</p></li>
<li><p>also fine to leave out variables that are uncorrelated with x_1 even if they have an effect on outcome.</p>
<ul>
<li>OVB is a product of these two. If one is zero then you are safe.</li>
</ul></li>
<li><p>You can leave out mediators.</p>
<ul>
<li><p>think school years -&gt; income</p>
<ul>
<li>you can leave out writing ability because it is a mediator.</li>
</ul></li>
</ul></li>
<li><p>I have a causal research question - wish i had a better research design but i don’t - thus this is the best I can do.</p></li>
<li><p>Propensity Score Matching</p></li>
</ul>
</section>
<section id="propensity-score-matching" class="level1">
<h1>Propensity Score Matching</h1>
<ul>
<li><p>Matching helps with figuring out an estimand</p></li>
<li><p>Balance is very important because it can bias our estimand.</p>
<ul>
<li>matching essentially allows you to rebalance your data</li>
</ul></li>
<li><p>we are not in RCT land.</p></li>
<li><p>we are going to need to match on more than just one variable</p></li>
<li><p>exact matching vs.&nbsp;propensity score in matching.</p></li>
<li><p>why use matching?</p>
<ul>
<li><p>no linear form assumption</p></li>
<li><p>OLS uses everyone. Matching only uses similar untreated obs.</p></li>
</ul></li>
<li><p>matching does not fix OVB.</p></li>
<li><p>tough part: how do we assign the weight on the untreated outcome.</p></li>
<li><p>OLS is not quite the same. What OLS is doing residuals on residuals.</p></li>
<li><p>Propensity score : the probability of being treated conditional on some Xs.</p>
<ul>
<li><p>we are going to collapse all of our Xs into one number 0-1 (probability)</p></li>
<li><p>Rosenbaum and Rubin (1983)</p></li>
</ul></li>
<li><p>prediction problem - what is the probability of being treated conditional on all the Xs.</p></li>
<li><p>Compare treated vs.&nbsp;untreated obs that have very similar propensity score matching.</p></li>
<li><p>need to show common support ALWAYS.</p></li>
<li><p>Nearest Neighbor Matching: find an obs that has the closest propensity score and use their untreated outcome.</p></li>
</ul>
</section>
<section id="panel-data" class="level1">
<h1>Panel Data</h1>
<ul>
<li><p>we’ve only been thinking about causality with cross sectional data.</p></li>
<li><p>but now we have data over time.</p></li>
<li><p>need to know long vs wide</p></li>
<li><p>Long data = multiple dates per cross-sectional data</p>
<ul>
<li>multiple rows for each observation across time</li>
</ul></li>
<li><p>Wide data = one observation - variables items are over time</p></li>
<li><p>stata panel commands want your data LONG.</p></li>
<li><p>reshape switches data from long to wide or vice versa.</p></li>
</ul>
</section>
<section id="diff-in-diff" class="level1">
<h1>Diff-in-Diff</h1>
<section id="when-to-use-it" class="level2">
<h2 class="anchored" data-anchor-id="when-to-use-it">When to Use It:</h2>
<ul>
<li><p>RCT is not an option</p></li>
<li><p>natural experiment = quasi-random event changes our ability to see treated vs.&nbsp;untreated outcomes.</p>
<ul>
<li><p>Good news: you don’t have to randomize anything</p></li>
<li><p>Bad news: frequently randomization is less than ideal</p>
<ul>
<li><p>usually treatment given to whole population</p></li>
<li><p>no obvious control group - you need to choose a comparison group.</p></li>
</ul></li>
</ul></li>
<li><p>Diff-in-diff is just basically you wanting to compare two groups.</p></li>
<li><p>basically it is 4 sub-group means.</p>
<ul>
<li><p>we can see</p>
<ul>
<li><p>g = group</p></li>
<li><p>t = period of being treated</p></li>
</ul></li>
</ul></li>
<li><p>Equal trends assumption is very important.</p>
<ul>
<li>fundamentally an assumption.</li>
</ul></li>
<li><p>Time is additive and separable</p></li>
<li><p>this hinges on who you select as the counterfactual.</p></li>
<li><p>you need to go to bat for your assumption.</p></li>
<li><p>we are going to impose the equal counterfactual assumption</p></li>
<li><p>KEY ASSUMPTION: Change over time for comparison group estimates counterfactual, i.e.&nbsp;what would have happened to treated group w/o treatment.</p></li>
</ul>
</section>
</section>
<section id="beyond-2x2-did---single-treatment-time" class="level1">
<h1>Beyond 2x2 DiD - Single Treatment Time</h1>
<ul>
<li><p>TWFE - group and time fixed effect</p></li>
<li><p>the goal is to convince the reader that you have equal counterfactual trends</p></li>
</ul>
<section id="placebo-analysis" class="level2">
<h2 class="anchored" data-anchor-id="placebo-analysis">Placebo Analysis</h2>
<ul>
<li><p>key idea: run diff-in-diff using an alternative outcome that should be unaffected. Hope for null results</p></li>
<li><p>this is basically a robustness check.</p></li>
<li><p>you do this after a diff-in-diff.</p></li>
<li><p>there is still linger concerns over the counterfactual so let me do this.</p></li>
<li><p>Rhetorically, it comes after the main results</p></li>
</ul>
</section>
<section id="triple-difference-setup" class="level2">
<h2 class="anchored" data-anchor-id="triple-difference-setup">Triple Difference Setup</h2>
<ul>
<li>key idea: run diff-in-diff on two different subgroups of observations</li>
</ul>
</section>
<section id="when-we-use-diff-in-diff-as-an-empirical-strategy" class="level2">
<h2 class="anchored" data-anchor-id="when-we-use-diff-in-diff-as-an-empirical-strategy">WHEN WE USE DIFF IN DIFF AS AN EMPIRICAL STRATEGY</h2>
<ul>
<li><p>we are making an assumption about a counterfactual outcome</p></li>
<li><p>we cannot prove the counterfactual assumption</p></li>
<li><p>we can make it more believable</p></li>
<li><p>DID depends on an assumption about a counterfactual; there is nothing you can do to formally test whether it’s true</p></li>
<li><p>Don’t say you have tested your fundamental assumption and passed.</p></li>
</ul>
</section>
<section id="synthetic-diff-in-diff" class="level2">
<h2 class="anchored" data-anchor-id="synthetic-diff-in-diff">Synthetic Diff-in-Diff</h2>
<ul>
<li><p>Setup: Natural Experiment with a single treated group.</p></li>
<li><p>take obs from donor pool -&gt; created weighted averge of donor pool then use as counterfactual.</p></li>
<li><p>I have real california then i need to make fake california - which is a weighted average from other states.</p></li>
<li><p>You use this instead of a diff-in-diff if there is no obvious counteractual case.</p></li>
<li><p>sythentic diff-in-diff is going to have really good equal trends but its going to be still a messy - you are still going to have defend that your synthetic control and its donor pool is going to be needed to defended because if you are just looking at lets say a treatment in california, your donor pool and sysntehtic control may get based off people from vermont and wyoming and etc. Which youll need to defend.</p></li>
<li><p>Algorithm picks it</p></li>
<li><p>you choose what to match on and what the donor pool is so there is still some research control.</p></li>
<li><p>Abadie, A., Diamond, A. and Hainmueller, J., 2010. Synthetic Control MEthods fo Comparative Case Studies: Estimating the effect of Californias tobacco control program. JASA</p></li>
<li><p>This method is good to get a point estimate of the treatment.</p></li>
</ul>
</section>
<section id="staggered-adoption-methods" class="level2">
<h2 class="anchored" data-anchor-id="staggered-adoption-methods">Staggered Adoption Methods</h2>
<ul>
<li><p>Very active recently</p></li>
<li><p>different groups and different time periods AND treatments are turning off and on</p></li>
</ul>
</section>
</section>
<section id="fixed-effects-and-panel-data" class="level1">
<h1>Fixed Effects and Panel Data</h1>
<ul>
<li><p>Fixed effects as a research methodology</p></li>
<li><p>Fixed effects isolates variation that we think identifies a causal relation</p></li>
<li><p>Grouped Data - usually same cross-sectional units in multiple time periods</p></li>
<li><p>“it” subscripts - an individual in a year.</p></li>
<li><p>unions operate in an area that is not perfectly competitive.</p>
<ul>
<li>if the firm is at the zero profit condition -&gt; then we dont expect unions -&gt; because a union would ask for more money and the union would say no -&gt; if they did, the firm would shutdown cause they wouldn’t be able to afford it.</li>
</ul></li>
<li><p>We believe that <span class="math inline">\(A_{it}\)</span> are the only thing standing between us and causality.</p></li>
<li><p>Required assumptions:</p>
<ul>
<li><p>Normally, we can’t do anything when we can only apply the CIA to a conditional expectation that includes unobservables in the conditioning set.</p>
<ul>
<li><p>we’ll assume the problem away.</p>
<ul>
<li><p>Expectation is linear and additive in all terms</p></li>
<li><p><span class="math inline">\(A_{it} = A_i\)</span> (Time-constant unobservables)</p></li>
<li><p>constant treatment effects.</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Controlling for who the person is!</p>
<ul>
<li><p>it is a categorical variable for basically “who is this”.</p></li>
<li><p>partialling out the effect of WHO these people are.</p></li>
<li><p>its going to change our comparison</p>
<ul>
<li>we are going compare people WITHIN.</li>
</ul></li>
</ul></li>
<li><p>we are just treating the person as a categorical variable.</p></li>
<li><p>shifting comparison from across to WITHIN!</p></li>
<li><p>for the union example</p>
<ul>
<li><p>looking at variation over time in union status (hopefully you have variation for that)</p>
<ul>
<li><p>so then you can say when that person is in a union job, they earn more versus when they arent.</p></li>
<li><p>you are losing a lot of data because you need a lot of within variation.</p></li>
<li><p>fixed effects increases standard errors.</p>
<ul>
<li>need to talk to brian about SE and FE and how they relate - bring in clustered SE discussion.</li>
</ul></li>
</ul></li>
</ul></li>
<li><p>If FE is run, should we ever believe their estimated effect?</p>
<ul>
<li>FE Doesn’t give us a causal estimate naturally. It is very hard.</li>
</ul></li>
<li><p>time-invariant is important. FE can only account for TIME INVARIANT!</p>
<ul>
<li>need to make sure that OVB is time invariant.</li>
</ul></li>
<li><p>FE IS SWITCHING FROM ACROSS TO WITHIN.</p></li>
<li><p>Why do i even have variation left?</p>
<ul>
<li>thought process - what out there in the world is leading to me having within variation.</li>
</ul></li>
<li><p>what kind of bias do we get with classical measurement error</p>
<ul>
<li><p>measurement error in y goes into the error</p></li>
<li><p>measurement error in x is attenuation bias - bias towards zero!</p>
<ul>
<li><p>x with noise!</p>
<ul>
<li>effects our beta</li>
</ul></li>
</ul></li>
</ul></li>
<li><p>FE helps with OVB BUT we might have measurement error in within variation that is not in cross-sectional.</p>
<ul>
<li>switch to variation that has a lot more noise with the within estimator leading to an attenuation.</li>
</ul></li>
</ul>
</section>
<section id="instrumental-variables" class="level1">
<h1>Instrumental Variables</h1>
<ul>
<li><p>Do problem set 7 and 8 for the midterm</p></li>
<li><p>IV helps solve OVB</p></li>
<li><p>If you can find an IV you can get the causal effect.</p></li>
<li><p>An IV must</p>
<ul>
<li><p>be related to x</p></li>
<li><p>AND exclusion restriction</p>
<ul>
<li><p>only reason you have a relationship between z and y is because of z affecting x.</p></li>
<li><p>Z CANNOT affect y DIRECTLY</p></li>
</ul>
<pre><code>-   it does not say z and y are unrelated.

    -   THEY ARE RELATED BUT ONLY THROUGH OUR X VARIABLE!

    -   z needs to be unrelated to the error term. Which are these observable</code></pre></li>
</ul></li>
<li><p>2 stage least squares IS instrumental variable.</p></li>
<li><p>The reason we do an IV is because we think this variable on Y is more interesting than the THIS STORM on Y.</p>
<ul>
<li>Structural equation is more interesting than the reduced form equation (See slides) THEN RUN AN IV!</li>
</ul></li>
<li><p>reduced form divided by the first stage coefficient</p></li>
<li><p>IV convincing when something actually doing randomizaiton.</p></li>
<li><p>INSTURMENT HAS TO GO THROUGH ENTIRELY THROUGH S</p></li>
<li><p>When reading/writing an IV paper</p>
<ul>
<li><p>start by defending the CIA for the reduced form - NECESSARY!</p>
<ul>
<li><p>reduced form regression is the causal effect of the instrument on the outcome!</p>
<ul>
<li>instrument is as good as randomly assigned</li>
</ul></li>
</ul></li>
<li><p>Figure 1 and Figure 2 - first stage and reduced form, same z on the x-axis</p></li>
<li><p>show the change from OLS - remember whole point is that OLS biased</p></li>
<li><p>Defend the exclusion restriction - False experiments with unaffected groups/time periods</p></li>
<li><p>specific suggestions for Bartik/examiner designs in papers on reading list.</p></li>
</ul></li>
<li><p>Late over ate is an external validity question</p>
<ul>
<li>can i take this causal estimate and generalize it beyond the context of this study.</li>
</ul></li>
<li></li>
</ul>
</section>
<section id="first-differences" class="level1">
<h1>First differences</h1>
<ul>
<li><p>measurement error in x leads to attenuation bias.</p></li>
<li><p>fixed effects is a linearity functional form. you assume it.</p></li>
<li><p>Subtract row from above it for each individual.</p></li>
<li><p>Which one to choose? Think about the DGP</p></li>
<li><p>FE compares all the time periods when someone is treated vs someone not treated.</p>
<ul>
<li><p>FD when a man goes to married from unmarried, is his income bigger?</p>
<ul>
<li>Do workers get bigger raises (From marriages) in the year the treatment occurs.</li>
</ul></li>
</ul></li>
<li><p>FD is kinda like regression discontinuity - effect of treatment is immediate</p></li>
<li><p>FD is good if effect of treatment is immediate.</p></li>
<li><p>regression is a tool for making comparisons</p>
<ul>
<li><p>it is a tool to compare observations to other observations</p>
<ul>
<li><p>what comparison are we going to make</p>
<ul>
<li>what regression is ‘right’ dependends on what comparison is ‘right’</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="standard-errors" class="level1">
<h1>Standard Errors</h1>
<p>Standard deviation of our estimated parameter</p>
<ul>
<li><p>standard error is an estimation of the standard deviation of our <span class="math inline">\(\beta\)</span></p></li>
<li><p>When we talk about a SE - it is our estimate of the standard deviation of the distribution of that <span class="math inline">\(\hat{\beta}\)</span></p></li>
<li><p>denominator in our t-stat</p></li>
<li><p>determines how wide our confidence interval is</p></li>
<li><p>THESE ARE ESTIMATED!</p></li>
<li><p>We are worried over rejecting a null.</p></li>
<li><p>how variable our beta hat is.</p></li>
<li><p>ROBUST SE IS JSUT TAKING THE MAIN DIAGONAL OF THE OMEGA MATRIX AND PUTTING THAT OMEGA INTO OUR SE. OFF DIAGONAL REMAINS 0</p>
<ul>
<li><p>INSTEAD OF AVERAGE, OBSERVATION SPECIFIC EPSILON HAT SQUARES ON DIAGONAL</p></li>
<li><p>OMEGA MATRIX IS STILL IN OLS SE BUT WE ASSUME ITS THE IDENTITY MATRIX</p></li>
</ul></li>
<li><p>Cluster SE is blocking the omega matrix along the main diagonal.</p></li>
<li><p>The cdf is the integral of our pdf</p></li>
<li><p>robust standard error literally calculates the main diagonal but then imposes zero on the off diagonals.</p></li>
<li><p>Four potential fixes</p>
<ul>
<li><p>parametric fixes - model the correlation</p></li>
<li><p>clustering - use white-like var-cov matrix, but allow for non-zero off-diagonal elements</p>
<ul>
<li>literally block along the main diagonal and some off diagonal. Errors are correlated with each other in each block.</li>
</ul></li>
<li><p>run group-level regressions</p></li>
<li><p>block bootstrap</p>
<ul>
<li></li>
</ul></li>
</ul></li>
</ul>
<section id="the-moulton-problem" class="level2">
<h2 class="anchored" data-anchor-id="the-moulton-problem">The Moulton Problem</h2>
<p>Fixed effects vs.&nbsp;Random Effects</p>
<ul>
<li><p>Random effects is the solution to</p>
<ul>
<li><p>unobserved things about the individual effect value of y and individual specific intercept</p>
<ul>
<li><p>uncorrelated with the treatment</p></li>
<li><p>random effects does not influence</p>
<ul>
<li><p>not including individual demeaning</p></li>
<li><p>not worried about omitted variable bias - we are just worried we dont have independent observations.</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Random effects is really just about autocorrelation. Fixed effects is to solve OVB.</p></li>
<li><p>Random effects is an alternative to clustering</p></li>
<li></li>
</ul>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{neilon2025,
  author = {Neilon, Stone},
  title = {Applied {Econometrics}},
  date = {2025-01-14},
  url = {https://stoneneilon.github.io/notes/American_Behavior/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-neilon2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Neilon, Stone. 2025. <span>“Applied Econometrics.”</span> January 14,
2025. <a href="https://stoneneilon.github.io/notes/American_Behavior/">https://stoneneilon.github.io/notes/American_Behavior/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>